<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ | –ü—Ä–µ–º–∏—É–º</title>

    <script
      src="https://integrationjs.tbank.ru/integration.js"
      onload="onPaymentIntegrationLoad()"
      async
    ></script>

    <style>
      /* –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ */
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
          Arial, sans-serif;
        background-color: #1a1b22; /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω, –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ */
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        color: #333;
      }

      /* –ë–µ–ª–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–ø–ª–∞—Ç—ã */
      .checkout-modal {
        background: #ffffff;
        padding: 40px 30px;
        border-radius: 24px;
        width: 100%;
        max-width: 360px;
        box-shadow: 0 24px 48px rgba(0, 0, 0, 0.2);
        text-align: center;
      }

      /* –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ —Ü–µ–Ω–∞ */
      .product-title {
        font-size: 18px;
        font-weight: 500;
        color: #111;
        margin-bottom: 8px;
      }

      .product-price {
        font-size: 28px;
        font-weight: 700;
        color: #111;
        margin-bottom: 30px;
      }

      /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫—É–¥–∞ –¢-–ë–∞–Ω–∫ –≤—Å—Ç–∞–≤–∏—Ç —Å–≤–æ–∏ –∫–Ω–æ–ø–∫–∏ */
      #payment-container {
        min-height: 200px;
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .footer-text {
        margin-top: 25px;
        font-size: 12px;
        color: #888;
      }
    </style>
  </head>
  <body>
    <div class="checkout-modal">
      <div class="product-title">–ö–æ–Ω—Ç–µ–Ω—Ç-–†—É–ª–µ—Ç–∫–∞ –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</div>
      <div class="product-price">34 900,00 ‚ÇΩ</div>

      <div id="payment-container">
        <p style="color: #999; font-size: 14px">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã...</p>
      </div>

      <div class="footer-text">üîí –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –¢-–ë–∞–Ω–∫</div>
    </div>

    <script>
      // 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
      const initConfig = {
        terminalKey: "1771969236528DEMO", // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–∞–±–æ—á–∏–π TerminalKey
        product: "eacq",
        features: {
          payment: {}, // –í–∫–ª—é—á–∞–µ–º –º–æ–¥—É–ª—å –∫–Ω–æ–ø–æ–∫ –æ–ø–ª–∞—Ç—ã
        },
      };

      // 2. –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Å–∫—Ä–∏–ø—Ç –±–∞–Ω–∫–∞ —Å–∫–∞—á–∞–ª—Å—è
      async function onPaymentIntegrationLoad() {
        try {
          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
          const integration = await PaymentIntegration.init(initConfig);

          // –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∞–º–∏
          const mainPaymentIntegration =
            await integration.payments.get("main-integration");

          // –£–∫–∞–∑—ã–≤–∞–µ–º, –≤ –∫–∞–∫–æ–π div –≤—Å—Ç–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
          const container = document.getElementById("payment-container");

          // –û—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç "–ó–∞–≥—Ä—É–∑–∫–∞..." –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
          container.innerHTML = "";

          await mainPaymentIntegration.mount(container);

          // 3. –í—ã–±–∏—Ä–∞–µ–º, –∫–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã –ø–æ–∫–∞–∑–∞—Ç—å (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –≤–∞—à–µ–º –õ–ö)
          // 'sbp' - –°–ë–ü, 'tpay' - T-Pay, 'bnpl' - –î–æ–ª—è–º–∏
          await mainPaymentIntegration.updateWidgetTypes([
            "sbp",
            "tpay",
            "bnpl",
          ]);

          // 4. –õ–æ–≥–∏–∫–∞ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É
          await integration.payments.setPaymentStartCallback(async () => {
            alert(
              "–û—Ç–ª–∏—á–Ω–æ! –ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞.\n\n–¢–µ–ø–µ—Ä—å –≤–∞—à —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É (PaymentURL) –∏ –≤–µ—Ä–Ω—É—Ç—å –µ—ë —Å—é–¥–∞.",
            );

            /* –ò–ú–ï–ù–ù–û –ó–î–ï–°–¨ –ö–†–û–ï–¢–°–Ø –°–ï–ö–†–ï–¢.
                 –ß—Ç–æ–±—ã –æ–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞, –≤–∞–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ fetch).
                 –°–µ—Ä–≤–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –¢-–ë–∞–Ω–∫–æ–º, –ø–æ–ª—É—á–∏—Ç PaymentURL –∏ –≤–µ—Ä–Ω–µ—Ç –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ.
                 
                 –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞:
                 const response = await fetch('/api/create-payment', { method: 'POST' });
                 const data = await response.json();
                 return data.PaymentURL;
                */
          });
        } catch (error) {
          console.error("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤–∏–¥–∂–µ—Ç–∞:", error);
          document.getElementById("payment-container").innerHTML =
            '<p style="color: red; font-size: 14px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à IP (–Ω—É–∂–µ–Ω –†–§) –∏ TerminalKey.</p>';
        }
      }
    </script>
  </body>
</html>
